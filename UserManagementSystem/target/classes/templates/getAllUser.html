<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>

        body{
          font-family: 'Airal', sans-serif;
          margin:0;
          padding:0;
          background-image: linear-gradient(135deg, #d7d2cc 10%, #304352 100%);
          height:auto;
          }

        h1{
          font-size:1.5rem;
          color:white;
          margin-top:0px;
        }

        #customers {
          border-collapse: collapse;
          width: 90%;
          box-shadow:0px 4px 8px rgba(0,0,0,0.1);
          border-radius: 10px;
          overflow: hidden;
          background: linear-gradient(120deg, #243949, #517fa4);
        }

        #customers td, #customers th {
          border: 1px solid #ddd;
          padding: 12px;
        }


        main{
         padding:20px;
        }

        header{
            background: linear-gradient(120deg, #252C42, #088395);
            color:#ecf0f1;
            padding: 1rem 0;
            text-align:left;
            font-size: 1.3rem;
            position: relative;
            text-transform: uppercase;
           }

        .moving-text {
            display: inline-block;
            position: relative;
            animation: moveText 15s infinite alternate; /* Animate only the text */
        }

        @keyframes moveText {
            0% {
                left: 0px;
            }
            100% {
                left: 1230px;
            }
        }

        .navBar{
         width:100%;
         background: rgba(0, 0, 0, 0.7);
         display:flex;
         justify-content:center;
         font-weight:bold;
         font-family: Arial, sans-serif;
         font-size:1.2rem;
         z-index:10;
         position:fixed;
         padding: 1rem 2rem;
        }

        .navBar a{
          font-size: 1.2rem;
          text-decoration:none;
          margin: 0rem 7rem;
          color:white;
          transition: color 0.3s;
        }

        .navBar a:hover{
          color: #00bcd4;
        }

        #customers tr:nth-child(even) {
         background-color: #088395;
         color: black;
         }

         #customers tr:nth-child(odd) {
          background-color: #2c3e50;
          border: 1px solid white;
          }

         #customers tr{
          transition:all 0.5s ease;
         }

        #customers tr:hover {
        background-color: #f1c40f;
        color:#2c3e50;
        cursor:pointer
        }

        #customers th, td {
          padding: 12px;
          text-align: center;
          color:white;
        }

        #customers th{
         background: linear-gradient(120deg, #252C42, #088395);
         color:#ecf0f1;

        }

        #customers a{
          color: white;
          text-decoration: none;
          font-weight: bold;
        }

        #customer td a:hove{
         text-decoration: underline;
         }

         .search-container{
           position: relative;
           margin-top:0px;
         }

         #search-input:hover{
          cursor: pointer;
          font-size: 13px;
          opacity:0.9;
          box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
         }

         .search-result{
           position:absolute;
           border:1px solid grey;
           width: 100%;
           padding:10px;
           background:white;
           display:none;
          }

          #search-input{
            border:1px solid grey;
            border-radius: 6px;
            padding:6px;
            margin-bottom:10px;
            box-shadow:12px 4px 8px rgba(0.1,0.1,0.1,0.1);
            background: white;
            font-weight: bold;
            width:30%;
            opacity:0.6;
            font-size: 12px;
            transition: font-size 0.5s ease;
          }

          #search-input::placeholder{
             color: grey;
             text-align:center;
             font:1rem;
          }

         .tableContainer{
            display:flex;
            justify-content:center;
          }

          table{
           border-radius:6px;
           }

          footer{
            text-align:center;
            margin-top:40px;
            font-size:0.9rem;
            color:white;
          }

          .btn{
            padding: 4px 6px;
            margin:5px;
            font-size:0.9rem;
            text-transform: uppercase;
            font-weight: bold;
            border: none;
            cursor:pointer;
            border-radius: 5px;
            display:inline;
          }

          .btn-update{
            background-color:#27ae60;
            color:white;
            text-decoration: none;
          }

          .btn-delete{
            background-color:#e74c3c;
            color:white;
          }

        .btn-update:hover {
            background-color: #1e8449;
        }

        .btn-delete:hover {
            background-color: #c0392b;
        }

        .logout{
          position: relative;
          display: flex;
          justify-content: right;
          margin-right:20px;
        }

         .passChg{
          display: inline-block;
          text-align:center;
          padding: 8px;
          margin:auto;
          width:30%;
          border-radius:6px;
          font-size: 0.9rem;
          font-weight:bold;
          background-image: linear-gradient(135deg, #B91372 10%, #6B0F1A 100%);
          color:white;
          transition:all 0.4s ease;
        }

        #logoutInp{
          padding: 8px;
          width:10%;
          border-radius:6px;
          border: 1px solid grey;
          font-size: 0.9rem;
          font-weight:bold;
          margin-top: 90px;
          background-image: linear-gradient(135deg, #B91372 10%, #6B0F1A 100%);
          color:white;
          transition:all 0.4s ease;
        }

        #logoutInp:hover{
         background-image: linear-gradient(135deg, #C33764 10%, #1D2671 100%);
         font-size: 15px;
         box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
        }

        #passIpt:hover{
         background-image: linear-gradient(135deg, #C33764 10%, #1D2671 100%);
         font-size: 15px;
         box-shadow: 0 6px 18px rgba(0, 0, 0, 0.2);
        }

        th.chngPassword {
         width: 10%;
         text-align: center;
         font-size: 0.9rem;
         white-space: nowrap;
         }

        th.chngPassword h6 {
         font-size: 0.6rem;
         margin: 0;
         color: #bdc3c7;
         }

        .action-button{
         display:flex;
         justify-content:center;
         align-items:center;
         gap:10px;
        }

    </style>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function search() {
            let input = document.getElementById("search-input").value.toLowerCase();
            let rows = document.querySelectorAll("#customers tbody tr");

            rows.forEach(row => {
                let cells = row.getElementsByTagName("td");
                let found = false;

                for (let cell of cells) {
                    if (cell.textContent.toLowerCase().includes(input)) {
                        found = true;
                        break;
                    }
                }
                if (found) {
                    row.style.display = "";
                } else {
                    row.style.display = "none";
                }
            });
        }


    </script>
</head>
<body>

<div class="navBar">
    <a th:href="@{/home}" id="home">Home</a>
    <a th:href="@{/profileController}">Profile</a>
    <a th:href="@{/aboutController}">About Us</a>
    <a th:href="@{/getAllUserData}">Dashboard</a>
</div>

<form class="logout" action="/logoutController" method="get">
    <input id="logoutInp" type="submit" value="Logout">
</form>

<!--<tr th:each="user : ${allUser}">-->

<main>
    <center>
        <h1>User Records</h1>

        <p th:if="${searchUserName != null}" th:text="'User found: ' + ${searchUserName.username}"></p>

        <div class="search-container my-4">

            <input onkeyup="search()" id="search-input" type="text" class="form-control"
                   placeholder="Search your user"/>

            <div class="search-result">

            </div>

        </div>


        <div class="tableContainer">

            <table id="customers">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>Username</th>
                    <th th:if="${loggedInUser != null and loggedInUser.role == 'admin'}">Password</th>
                    <th>Email</th>
                    <th>Role</th>
                    <th th:if="${loggedInUser != null and loggedInUser.role == 'admin'}">Action</th>
                    <th class="chngPassword" th:if="${loggedInUser != null and loggedInUser.role != 'admin'}">Chg Password <h6>Only logged-in user can see and edit the password</h6></th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="user : ${allUser}">
                    <td th:if="${loggedInUser != null and (loggedInUser.role == 'admin' or loggedInUser.id == user.id)}"
                        th:text="${user.id}"></td>
                    <td th:if="${loggedInUser != null and (loggedInUser.role == 'admin' or loggedInUser.id == user.id)}"
                        th:text="${user.firstname}"></td>
                    <td th:if="${loggedInUser != null and (loggedInUser.role == 'admin' or loggedInUser.id == user.id)}"
                        th:text="${user.lastname}"></td>
                    <td th:if="${loggedInUser != null and (loggedInUser.role == 'admin' or loggedInUser.id == user.id)}"
                        th:text="${user.username}"></td>

                    <td th:if="${loggedInUser != null and loggedInUser.role == 'admin'}"
                        th:text="${user.password}"></td>

                    <td th:if="${loggedInUser != null and (loggedInUser.role == 'admin' or loggedInUser.id == user.id)}"
                        th:text="${user.email}"></td>
                    <td th:if="${loggedInUser != null and (loggedInUser.role == 'admin' or loggedInUser.id == user.id)}"
                        th:text="${user.role}"></td>

                    <td th:if="${loggedInUser != null and loggedInUser.role == 'admin'}">

                        <div class="action-button">

                        <a th:href="@{/updateProcess/{id}(id=${user.id})}" class="btn btn-update">Update</a>

                        <form th:action="@{/deleteProcess/{id}(id=${user.id})}" method="post" onsubmit="return confirm('Are you sure you want to delete this user?');">
                            <input type="hidden" value="DELETE" name="_method" />
                            <input type="submit" value="Delete" class="btn btn-delete"/>
                        </form>

                        </div>

                    </td>

                    <td th:if="${loggedInUser != null and loggedInUser.id == user.id and loggedInUser.role != 'admin'}">
                        <a class="passChg" th:href="@{/verifyUser/{username}(username=${user.username})}">
                            EDIT
                        </a>
                    </td>

                </tr>
                </tbody>
            </table>
        </div>
    </center>


</main>


<footer>
    &copy; 2024 User Management System. All Rights Reserved.
</footer>


</body>
</html>
